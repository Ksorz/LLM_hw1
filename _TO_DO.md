# Суть проекта

Необходимо реализовать полноценный ML-сервис, который сможет сделать прогон данных обученной модели ML.


## Минимальные требования к проекту

* Сервис должен быть реализован на Flask или FastAPI  
* В Flask/FastAPI должен быть route типа POST на /forward, который должен принимать один из двух форматов:  
  * Если данные не содержат изображений, то необходимо передавать входные данные в теле запроса в формате JSON  
  * Если данные содержат изображение, то необходимо послать изображение в виде multipart/form-data запроса (обычная форма), параметр image. Дополнительные параметры для входа необходимо передавать в header-е проекта  
* Результатом /forward должен быть ответ в необходимом формате:  
  * Если запрос неверного формата, то должен возвращаться код ошибки 400 с текстом ‘bad request’  
  * Если модель не смогла выполнить работу, то необходимо вернуть код ошибки 403 и вернуть сообщение: “модель не смогла обработать данные”  
  * Если модель отработала, то возвращаем результаты в одном из подходящих форматов:  
    * Если данные не содержат изображений, то необходимо вернуть результаты в формате JSON  
    * Если данные содержит изображение, то необходимо будет вернуть изображение в формате base64, зашив его в поле в JSON-документе

Для сдачи необходимо предоставить код обучения моделей. В результате работы обучения необходимо получить модель, которую потом можно будет запустить в веб\-сервисе\!

При этом стараемся структурировать код проекта так, чтобы код прогона моделей и код обучения моделей не был копипастой\!

## Усложнение 0

* Необходимо завернуть сервис в docker-compose, вынести следующие сервисы:  
  * Фронтенд  
  * Backend (обработка моделей)  
  * DB \- feature storage  
  * Monitoring

## Усложнение 1

* Необходимо превратить сохраненную модель в формат, который не зависит от библиотеки обучения моделей. Таким форматом является формат .onnx. При этом необходимо зашить в модель следующие метаданные:  
  * Hash коммита  
  * Дата сохранения модели  
  * Название эксперимента  
* В API необходимо добавить запрос /metadata, в котором можно будет получить данные модели из предыдущего пункта

## Усложнение 2

* Необходимо построить pipeline обучения ML-модели через dvc или MLFlow  
* Необходимо создать стадии extract\_data, train\_model, inference\_model \- в результатах выхода стадий должны быть артефакты:  
  * Метрики  
  * Графики обучения  
  * Сохранённые модели  
* Если решение является нейросетевым или использующим градиентные методы \- необходимо сохранять результаты обучения в виде графиков в Tensorboard

## Усложнение 3

* Необходимо реализовать запросы:  
  * POST /forward\_batch \- в котором необходимо загружать для прогона несколько объектов  
  * POST /evaluate \- в котором необходимо реализовать параметры /forward\_batch, но дополнительно ещё необходимо вернуть метрики для загруженного датасета. Продумайте удобный формат для загрузки данных:  
    * .csv-файл, если нет данных с изображениями  
    * .zip-файл, в которых есть данные с изображениями/видео

## Усложнение 4

* Необходимо реализовать полный pipeline модели:  
  * PUT /add\_data \- добавляет к текущему датасету новые данные (формат данных должен быть согласован с /evaluate, только необходимо будет загружать метки правильных ответов)  
  * PUT /retrain \- метод, который позволяет производить **обучение модели.** После обучения модели необходимо будет вернуть id эксперимента, по которому можно дальше обратиться  
  * GET /metrics/\<int:experiment\_id\> \- возвращает метрики для эксперимента  
  * POST /deploy/\<int:experiment\_id\> \- заменяет текущую модель эксперимента на новую с необходимым номером эксперимента

## Усложнение 5

* Результаты прогонов сервиса сохраняются в средстве мониторинга. Данные можно посмотреть в сервисе Grafana. 

  * 

## Требования

* Минимум кода в ноутбуках \- только для построения визуализаций  
* Красивый репозиторий \- стараемся структуризировать модули  
* Упаковка как можно большего количества частей проекта в виде Docker-image  
* Используйте flake8 для проверки code style

 

# Баллы за проект:

* Базовая часть проекта стоит 8 баллов  
* Каждое усложнение стоит по 8 баллов

## Командное участие:

* Проект можно делать в группах. Тогда суммарный балл за проект делится на количество участников в проекте

